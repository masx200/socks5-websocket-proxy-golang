# SOCKS5-WebSocket ä»£ç†ç³»ç»Ÿ

ä¸€ä¸ªä½¿ç”¨ Go è¯­è¨€å¼€å‘çš„é«˜æ€§èƒ½ç½‘ç»œä»£ç†ç³»ç»Ÿï¼Œæ”¯æŒ SOCKS5 å’Œ WebSocket
åè®®é—´çš„çµæ´»è½¬å‘å’Œç»Ÿä¸€æ¥å£å°è£…ã€‚

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ—¨åœ¨æä¾›ä¸€ä¸ªé«˜æ€§èƒ½ã€å¯æ‰©å±•çš„ä»£ç†è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå¤šç§ä¸Šæ¸¸è¿æ¥æ–¹å¼å’ŒåŠ¨æ€é…ç½®ã€‚ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒåè®®é—´çš„çµæ´»è½¬å‘ï¼Œé€‚ç”¨äºå„ç§ç½‘ç»œä»£ç†åœºæ™¯ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸš€ æ ¸å¿ƒåŠŸèƒ½

- **å¤šåè®®æ”¯æŒ**: æ”¯æŒ SOCKS5 å’Œ WebSocket åè®®
- **åè®®è½¬æ¢**: æ”¯æŒä¸åŒåè®®é—´çš„æ•°æ®è½¬å‘
- **ä¸Šæ¸¸è¿æ¥é€‰æ‹©**: æ”¯æŒå¤šç§ä¸Šæ¸¸è¿æ¥æ–¹å¼å’ŒåŠ¨æ€é€‰æ‹©ç­–ç•¥
- **è®¤è¯æœºåˆ¶**: æ”¯æŒç”¨æˆ·åå¯†ç è®¤è¯
- **é«˜å¹¶å‘**: æ”¯æŒå¤šå®¢æˆ·ç«¯å¹¶å‘è¿æ¥

### ğŸ”§ æŠ€æœ¯ç‰¹æ€§

- **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„æ¶æ„åˆ†å±‚ï¼Œæ˜“äºæ‰©å±•
- **é…ç½®ç®¡ç†**: æ”¯æŒ JSON é…ç½®æ–‡ä»¶å’Œå‘½ä»¤è¡Œå‚æ•°
- **å¥åº·æ£€æŸ¥**: å†…ç½®è¿æ¥å¥åº·æ£€æŸ¥æœºåˆ¶
- **æ•…éšœè½¬ç§»**: æ”¯æŒè‡ªåŠ¨æ•…éšœè½¬ç§»å’Œé‡è¿
- **IPv6 æ”¯æŒ**: å®Œæ•´æ”¯æŒ IPv4ã€IPv6 å’ŒåŸŸåè§£æ

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SOCKS5 Client â”‚    â”‚ WebSocket Clientâ”‚    â”‚   Direct Client â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Upstream Selector       â”‚
                    â”‚  (åŠ¨æ€é€‰æ‹©ä¸Šæ¸¸è¿æ¥æ–¹å¼)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                      â”‚                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SOCKS5 Server â”‚    â”‚ WebSocket Serverâ”‚    â”‚   Direct Server â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å®‰è£…è¯´æ˜

### ç¯å¢ƒè¦æ±‚

- Go 1.19+
- æ“ä½œç³»ç»Ÿ: Windows/Linux/macOS

### ç¼–è¯‘å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/socks5-websocket-proxy-golang.git
cd socks5-websocket-proxy-golang

# ä¸‹è½½ä¾èµ–
go mod tidy

# ç¼–è¯‘
go build -o proxy-server.exe cmd/main.go

# è¿è¡Œ
./proxy-server.exe
```

## å¿«é€Ÿå¼€å§‹

### 1. æœåŠ¡ç«¯æ¨¡å¼

#### ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°å¯åŠ¨

```bash
# å¯åŠ¨ SOCKS5 æœåŠ¡ç«¯
./proxy-server.exe -mode server -protocol socks5 -addr :1080 -username admin -password password123

# å¯åŠ¨ WebSocket æœåŠ¡ç«¯
./proxy-server.exe -mode server -protocol websocket -addr :8080 -username admin -password password123
```

#### ä½¿ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨

```bash
./proxy-server.exe -mode server -config config/server-config.json
```

### 2. å®¢æˆ·ç«¯æ¨¡å¼

```bash
# è¿æ¥åˆ°ç›®æ ‡ä¸»æœº
./proxy-server.exe -mode client -protocol socks5 -addr proxy-server.com:1080 -username admin -password password123 -host target.com -port 80
```

**è¯¦ç»†ä½¿ç”¨æŒ‡å—**: è¯·æŸ¥çœ‹ [å®¢æˆ·ç«¯æ¨¡å¼ä½¿ç”¨æŒ‡å—](CLIENT_MODE_GUIDE.md)
è·å–æ›´è¯¦ç»†çš„å®¢æˆ·ç«¯æ¨¡å¼ä½¿ç”¨è¯´æ˜ï¼ŒåŒ…æ‹¬ SOCKS5 å’Œ WebSocket
åè®®çš„å…·ä½“é…ç½®æ–¹æ³•å’Œå®é™…åº”ç”¨åœºæ™¯ã€‚

## é…ç½®è¯´æ˜

### é…ç½®æ–‡ä»¶æ ¼å¼

é…ç½®æ–‡ä»¶ä½¿ç”¨ JSON æ ¼å¼ï¼Œæ”¯æŒä»¥ä¸‹é…ç½®é¡¹ï¼š

#### åŸºæœ¬é…ç½®

- `listen_addr`: ç›‘å¬åœ°å€ï¼Œæ ¼å¼ä¸º `:ç«¯å£` æˆ– `IP:ç«¯å£`
- `protocol`: åè®®ç±»å‹ï¼Œæ”¯æŒ `socks5` æˆ– `websocket`
- `timeout`: è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºçº³ç§’ï¼ˆ30 ç§’ = 30000000000ï¼‰

#### è®¤è¯é…ç½®

- `auth_users`: ç”¨æˆ·è®¤è¯ä¿¡æ¯ï¼Œæ ¼å¼ä¸º `"ç”¨æˆ·å": "å¯†ç "`

#### ä¸Šæ¸¸è¿æ¥é…ç½®

- `enable_upstream`: æ˜¯å¦å¯ç”¨ä¸Šæ¸¸è¿æ¥é€‰æ‹©å™¨
- `upstream_config`: ä¸Šæ¸¸è¿æ¥é…ç½®åˆ—è¡¨

##### ä¸Šæ¸¸è¿æ¥ç±»å‹

- `type`: `"direct"` = TCP ç›´è¿ï¼Œ`"socks5"` = SOCKS5 ä»£ç†ï¼Œ`"websocket"` =
  WebSocket ä»£ç†
- `proxy_address`: ä»£ç†æœåŠ¡å™¨åœ°å€
- `proxy_username`: ä»£ç†ç”¨æˆ·å
- `proxy_password`: ä»£ç†å¯†ç 
- `timeout`: ä»£ç†è¿æ¥è¶…æ—¶æ—¶é—´

### é…ç½®ç¤ºä¾‹

#### 1. åŸºæœ¬ SOCKS5 æœåŠ¡ç«¯

```json
{
  "listen_addr": ":1080",
  "protocol": "socks5",
  "timeout": 30000000000,
  "auth_users": {
    "admin": "password123"
  },
  "enable_upstream": false,
  "upstream_config": [
    {
      "type": "direct",
      "proxy_address": "",
      "proxy_username": "",
      "proxy_password": "",
      "timeout": 30000000000
    }
  ]
}
```

#### 2. å¯ç”¨ä¸Šæ¸¸è¿æ¥é€‰æ‹©å™¨

```json
{
  "listen_addr": ":1080",
  "protocol": "socks5",
  "timeout": 30000000000,
  "auth_users": {
    "admin": "password123",
    "user1": "pass123"
  },
  "enable_upstream": true,
  "upstream_config": [
    {
      "type": "direct",
      "proxy_address": "",
      "proxy_username": "",
      "proxy_password": "",
      "timeout": 30000000000
    },
    {
      "type": "socks5",
      "proxy_address": "proxy.example.com:1080",
      "proxy_username": "proxy_user",
      "proxy_password": "proxy_pass",
      "timeout": 30000000000
    },
    {
      "type": "websocket",
      "proxy_address": "ws://websocket-proxy.example.com:8080/proxy",
      "proxy_username": "ws_user",
      "proxy_password": "ws_pass",
      "timeout": 30000000000
    }
  ]
}
```

## ä¸Šæ¸¸è¿æ¥é€‰æ‹©ç­–ç•¥

ç³»ç»Ÿæ”¯æŒå¤šç§ä¸Šæ¸¸è¿æ¥é€‰æ‹©ç­–ç•¥ï¼š

### 1. è½®è¯¢ç­–ç•¥ (Round Robin)

æŒ‰é¡ºåºè½®æµé€‰æ‹©å¯ç”¨çš„ä¸Šæ¸¸è¿æ¥

### 2. éšæœºç­–ç•¥ (Random)

éšæœºé€‰æ‹©å¯ç”¨çš„ä¸Šæ¸¸è¿æ¥

### 3. åŠ æƒç­–ç•¥ (Weighted)

æ ¹æ®æƒé‡é€‰æ‹©ä¸Šæ¸¸è¿æ¥ï¼ˆåŸºäºè¶…æ—¶æ—¶é—´è®¡ç®—æƒé‡ï¼‰

### 4. æ•…éšœè½¬ç§»ç­–ç•¥ (Failover)

ä¼˜å…ˆé€‰æ‹©ç¬¬ä¸€ä¸ªå¥åº·çš„ä¸Šæ¸¸è¿æ¥

## åè®®æ”¯æŒ

### SOCKS5 åè®®

- å®Œæ•´æ”¯æŒ SOCKS5 åè®® (RFC 1928)
- æ”¯æŒç”¨æˆ·åå¯†ç è®¤è¯ (RFC 1929)
- æ”¯æŒåŸŸåè§£æå’Œ IPv4/IPv6 è¿æ¥
- æ”¯æŒ CONNECT å‘½ä»¤

### WebSocket åè®®

- æ”¯æŒ WebSocket åè®®å®Œæ•´å®ç°
- é€šè¿‡ HTTP Headers ä¼ é€’è®¤è¯ä¿¡æ¯
- æ”¯æŒè¿æ¥é‡è¯•å’Œé”™è¯¯æ¢å¤
- æ”¯æŒäºŒè¿›åˆ¶æ•°æ®ä¼ è¾“

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
socks5-websocket-proxy-golang/
â”œâ”€â”€ cmd/                    # å‘½ä»¤è¡Œå…¥å£
â”‚   â””â”€â”€ main.go            # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ server-config.json # æœåŠ¡ç«¯é…ç½®ç¤ºä¾‹

â”œâ”€â”€ internal/              # å†…éƒ¨åŒ…
â”œâ”€â”€ pkg/                   # å¯é‡ç”¨åŒ…
â”‚   â”œâ”€â”€ interfaces/        # æ¥å£å®šä¹‰
â”‚   â”œâ”€â”€ proxy/            # ä»£ç†å®ç°
â”‚   â”œâ”€â”€ socks5/           # SOCKS5 åè®®å®ç°
â”‚   â”œâ”€â”€ upstream/         # ä¸Šæ¸¸è¿æ¥é€‰æ‹©å™¨
â”‚   â””â”€â”€ websocket/        # WebSocket åè®®å®ç°
â”œâ”€â”€ tests/                # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ examples/             # ç¤ºä¾‹é…ç½®
â”œâ”€â”€ go.mod                # Go æ¨¡å—æ–‡ä»¶
â””â”€â”€ README.md             # é¡¹ç›®è¯´æ˜
```

### æ ¸å¿ƒæ¥å£

#### ProxyClient æ¥å£

```go
type ProxyClient interface {
    Connect(host string, port int) error
    Authenticate(username, password string) error
    ForwardData(conn net.Conn) error
    Close() error
}
```

#### ProxyServer æ¥å£

```go
type ProxyServer interface {
    Listen() error
    HandleConnection(conn net.Conn) error
    Authenticate(username, password string) bool
    SelectUpstreamConnection(targetHost string, targetPort int) (net.Conn, error)
    Shutdown() error
}
```

## æ€§èƒ½ä¼˜åŒ–

### å¹¶å‘å¤„ç†

- ä½¿ç”¨ goroutine æ± ç®¡ç†å¹¶å‘è¿æ¥
- å®ç°è¿æ¥æ•°é™åˆ¶å’Œè¶…æ—¶æ§åˆ¶
- æ”¯æŒä¼˜é›…å…³é—­å’Œèµ„æºæ¸…ç†
- å®ç°èƒŒå‹æœºåˆ¶é˜²æ­¢è¿‡è½½

### å†…å­˜ä¼˜åŒ–

- ä½¿ç”¨ç¼“å†²æ± å‡å°‘å†…å­˜åˆ†é…
- å®ç°é›¶æ‹·è´æ•°æ®ä¼ è¾“
- æ”¯æŒæµå¼å¤„ç†å¤§æ–‡ä»¶

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. è¿æ¥è¢«æ‹’ç»

- æ£€æŸ¥ç›‘å¬åœ°å€æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ç«¯å£æœªè¢«å ç”¨
- éªŒè¯é˜²ç«å¢™è®¾ç½®

#### 2. è®¤è¯å¤±è´¥

- æ£€æŸ¥ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®
- ç¡®è®¤é…ç½®æ–‡ä»¶æ ¼å¼æ­£ç¡®
- éªŒè¯è®¤è¯ä¿¡æ¯æ˜¯å¦æ­£ç¡®åŠ è½½

#### 3. ä¸Šæ¸¸è¿æ¥å¤±è´¥

- æ£€æŸ¥ä¸Šæ¸¸ä»£ç†æœåŠ¡å™¨åœ°å€
- éªŒè¯ä¸Šæ¸¸ä»£ç†è®¤è¯ä¿¡æ¯
- ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸

### æ—¥å¿—è°ƒè¯•

ç³»ç»Ÿæä¾›è¯¦ç»†çš„æ—¥å¿—ä¿¡æ¯ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼š

```bash
./proxy-server.exe -mode server -v
```

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€: https://github.com/yourusername/socks5-websocket-proxy-golang
- é—®é¢˜åé¦ˆ: https://github.com/yourusername/socks5-websocket-proxy-golang/issues

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-06-23)

- âœ… å®Œæˆæ ¸å¿ƒåŠŸèƒ½å¼€å‘
- âœ… æ”¯æŒ SOCKS5 å’Œ WebSocket åè®®
- âœ… å®ç°ä¸Šæ¸¸è¿æ¥é€‰æ‹©å™¨
- âœ… æ”¯æŒå¤šç§é€‰æ‹©ç­–ç•¥å’Œå¥åº·æ£€æŸ¥
- âœ… å®Œå–„é…ç½®ç®¡ç†å’Œæ–‡æ¡£
- âœ… ä¿®æ”¹ UpstreamType ä¸ºå­—ç¬¦ä¸²ç±»å‹
